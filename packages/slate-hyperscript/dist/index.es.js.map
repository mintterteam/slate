{"version":3,"file":"index.es.js","sources":["../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/esm/defineProperty.js","../src/tokens.ts","../src/creators.ts","../src/hyperscript.ts","../src/index.ts"],"sourcesContent":["export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","import { Node, Path, Text } from 'slate'\n\n/**\n * A weak map to hold anchor tokens.\n */\n\nconst ANCHOR: WeakMap<Node, [number, AnchorToken]> = new WeakMap()\n\n/**\n * A weak map to hold focus tokens.\n */\n\nconst FOCUS: WeakMap<Node, [number, FocusToken]> = new WeakMap()\n\n/**\n * All tokens inherit from a single constructor for `instanceof` checking.\n */\n\nexport class Token {}\n\n/**\n * Anchor tokens represent the selection's anchor point.\n */\n\nexport class AnchorToken extends Token {\n  offset?: number\n  path?: Path\n\n  constructor(\n    props: {\n      offset?: number\n      path?: Path\n    } = {}\n  ) {\n    super()\n    const { offset, path } = props\n    this.offset = offset\n    this.path = path\n  }\n}\n\n/**\n * Focus tokens represent the selection's focus point.\n */\n\nexport class FocusToken extends Token {\n  offset?: number\n  path?: Path\n\n  constructor(\n    props: {\n      offset?: number\n      path?: Path\n    } = {}\n  ) {\n    super()\n    const { offset, path } = props\n    this.offset = offset\n    this.path = path\n  }\n}\n\n/**\n * Add an anchor token to the end of a text node.\n */\n\nexport const addAnchorToken = (text: Text, token: AnchorToken) => {\n  const offset = text.value.length\n  ANCHOR.set(text, [offset, token])\n}\n\n/**\n * Get the offset if a text node has an associated anchor token.\n */\n\nexport const getAnchorOffset = (\n  text: Text\n): [number, AnchorToken] | undefined => {\n  return ANCHOR.get(text)\n}\n\n/**\n * Add a focus token to the end of a text node.\n */\n\nexport const addFocusToken = (text: Text, token: FocusToken) => {\n  const offset = text.value.length\n  FOCUS.set(text, [offset, token])\n}\n\n/**\n * Get the offset if a text node has an associated focus token.\n */\n\nexport const getFocusOffset = (\n  text: Text\n): [number, FocusToken] | undefined => {\n  return FOCUS.get(text)\n}\n","import { Element, Descendant, Node, Range, Text, Editor } from 'slate'\nimport {\n  AnchorToken,\n  FocusToken,\n  Token,\n  addAnchorToken,\n  addFocusToken,\n  getAnchorOffset,\n  getFocusOffset,\n} from './tokens'\n\n/**\n * Resolve the descedants of a node by normalizing the children that can be\n * passed into a hyperscript creator function.\n */\n\nconst STRINGS: WeakSet<Text> = new WeakSet()\n\nconst resolveDescendants = (children: any[]): Descendant[] => {\n  const nodes: Node[] = []\n\n  const addChild = (child: Node | Token): void => {\n    if (child == null) {\n      return\n    }\n\n    const prev = nodes[nodes.length - 1]\n\n    if (typeof child === 'string') {\n      const text: Text = { type: 'text', value: child }\n      STRINGS.add(text)\n      child = text\n    }\n\n    if (Text.isText(child)) {\n      const c = child // HACK: fix typescript complaining\n\n      if (\n        Text.isText(prev) &&\n        STRINGS.has(prev) &&\n        STRINGS.has(c) &&\n        Text.equals(prev, c, { loose: true })\n      ) {\n        prev.value += c.value\n      } else {\n        nodes.push(c)\n      }\n    } else if (Element.isElement(child)) {\n      nodes.push(child)\n    } else if (child instanceof Token) {\n      let n = nodes[nodes.length - 1]\n\n      if (!Text.isText(n)) {\n        addChild('')\n        n = nodes[nodes.length - 1] as Text\n      }\n\n      if (child instanceof AnchorToken) {\n        addAnchorToken(n, child)\n      } else if (child instanceof FocusToken) {\n        addFocusToken(n, child)\n      }\n    } else {\n      throw new Error(`Unexpected hyperscript child object: ${child}`)\n    }\n  }\n\n  for (const child of children.flat(Infinity)) {\n    addChild(child)\n  }\n\n  return nodes\n}\n\n/**\n * Create an anchor token.\n */\n\nexport function createAnchor(\n  tagName: string,\n  attributes: { [key: string]: any },\n  children: any[]\n): AnchorToken {\n  return new AnchorToken(attributes)\n}\n\n/**\n * Create an anchor and a focus token.\n */\n\nexport function createCursor(\n  tagName: string,\n  attributes: { [key: string]: any },\n  children: any[]\n): Token[] {\n  return [new AnchorToken(attributes), new FocusToken(attributes)]\n}\n\n/**\n * Create an `Element` object.\n */\n\nexport function createElement(\n  tagName: string,\n  attributes: { [key: string]: any },\n  children: any[]\n): Element {\n  return { ...attributes, children: resolveDescendants(children) }\n}\n\n/**\n * Create a focus token.\n */\n\nexport function createFocus(\n  tagName: string,\n  attributes: { [key: string]: any },\n  children: any[]\n): FocusToken {\n  return new FocusToken(attributes)\n}\n\n/**\n * Create a fragment.\n */\n\nexport function createFragment(\n  tagName: string,\n  attributes: { [key: string]: any },\n  children: any[]\n): Descendant[] {\n  return resolveDescendants(children)\n}\n\n/**\n * Create a `Selection` object.\n */\n\nexport function createSelection(\n  tagName: string,\n  attributes: { [key: string]: any },\n  children: any[]\n): Range {\n  const anchor: AnchorToken = children.find(c => c instanceof AnchorToken)\n  const focus: FocusToken = children.find(c => c instanceof FocusToken)\n\n  if (!anchor || anchor.offset == null || anchor.path == null) {\n    throw new Error(\n      `The <selection> hyperscript tag must have an <anchor> tag as a child with \\`path\\` and \\`offset\\` attributes defined.`\n    )\n  }\n\n  if (!focus || focus.offset == null || focus.path == null) {\n    throw new Error(\n      `The <selection> hyperscript tag must have a <focus> tag as a child with \\`path\\` and \\`offset\\` attributes defined.`\n    )\n  }\n\n  return {\n    anchor: {\n      offset: anchor.offset,\n      path: anchor.path,\n    },\n    focus: {\n      offset: focus.offset,\n      path: focus.path,\n    },\n    ...attributes,\n  }\n}\n\n/**\n * Create a `Text` object.\n */\n\nexport function createText(\n  tagName: string,\n  attributes: { [key: string]: any },\n  children: any[]\n): Text {\n  const nodes = resolveDescendants(children)\n\n  if (nodes.length > 1) {\n    throw new Error(\n      `The <text> hyperscript tag must only contain a single node's worth of children.`\n    )\n  }\n\n  let [node] = nodes\n\n  if (node == null) {\n    node = { type: 'text', value: '' }\n  }\n\n  if (!Text.isText(node)) {\n    throw new Error(`\n    The <text> hyperscript tag can only contain text content as children.`)\n  }\n\n  // COMPAT: If they used the <text> tag we want to guarantee that it won't be\n  // merge with other string children.\n  STRINGS.delete(node)\n\n  Object.assign(node, attributes)\n  return node\n}\n\n/**\n * Create a top-level `Editor` object.\n */\n\nexport const createEditor = (makeEditor: () => Editor) => (\n  tagName: string,\n  attributes: { [key: string]: any },\n  children: any[]\n): Editor => {\n  const otherChildren: any[] = []\n  let selectionChild: Range | undefined\n\n  for (const child of children) {\n    if (Range.isRange(child)) {\n      selectionChild = child\n    } else {\n      otherChildren.push(child)\n    }\n  }\n\n  const descendants = resolveDescendants(otherChildren)\n  const selection: Partial<Range> = {}\n  const editor = makeEditor()\n  Object.assign(editor, attributes)\n  editor.children = descendants as Element[]\n\n  // Search the document's texts to see if any of them have tokens associated\n  // that need incorporated into the selection.\n  for (const [node, path] of Node.texts(editor)) {\n    const anchor = getAnchorOffset(node)\n    const focus = getFocusOffset(node)\n\n    if (anchor != null) {\n      const [offset] = anchor\n      selection.anchor = { path, offset }\n    }\n\n    if (focus != null) {\n      const [offset] = focus\n      selection.focus = { path, offset }\n    }\n  }\n\n  if (selection.anchor && !selection.focus) {\n    throw new Error(\n      `Slate hyperscript ranges must have both \\`<anchor />\\` and \\`<focus />\\` defined if one is defined, but you only defined \\`<anchor />\\`. For collapsed selections, use \\`<cursor />\\` instead.`\n    )\n  }\n\n  if (!selection.anchor && selection.focus) {\n    throw new Error(\n      `Slate hyperscript ranges must have both \\`<anchor />\\` and \\`<focus />\\` defined if one is defined, but you only defined \\`<focus />\\`. For collapsed selections, use \\`<cursor />\\` instead.`\n    )\n  }\n\n  if (selectionChild != null) {\n    editor.selection = selectionChild\n  } else if (Range.isRange(selection)) {\n    editor.selection = selection\n  }\n\n  return editor\n}\n","import { isPlainObject } from 'is-plain-object'\nimport { Element, createEditor as makeEditor } from 'slate'\nimport {\n  createAnchor,\n  createCursor,\n  createEditor,\n  createElement,\n  createFocus,\n  createFragment,\n  createSelection,\n  createText,\n} from './creators'\n\n/**\n * The default creators for Slate objects.\n */\n\nconst DEFAULT_CREATORS = {\n  anchor: createAnchor,\n  cursor: createCursor,\n  editor: createEditor(makeEditor),\n  element: createElement,\n  focus: createFocus,\n  fragment: createFragment,\n  selection: createSelection,\n  text: createText,\n}\n\n/**\n * `HyperscriptCreators` are dictionaries of `HyperscriptCreator` functions\n * keyed by tag name.\n */\n\ntype HyperscriptCreators<T = any> = Record<\n  string,\n  (tagName: string, attributes: { [key: string]: any }, children: any[]) => T\n>\n\n/**\n * `HyperscriptShorthands` are dictionaries of properties applied to specific\n * kind of object, keyed by tag name. They allow you to easily define custom\n * hyperscript tags for your domain.\n */\n\ntype HyperscriptShorthands = Record<string, Record<string, any>>\n\n/**\n * Create a Slate hyperscript function with `options`.\n */\n\nconst createHyperscript = (\n  options: {\n    creators?: HyperscriptCreators\n    elements?: HyperscriptShorthands\n  } = {}\n) => {\n  const { elements = {} } = options\n  const elementCreators = normalizeElements(elements)\n  const creators = {\n    ...DEFAULT_CREATORS,\n    ...elementCreators,\n    ...options.creators,\n  }\n\n  const jsx = createFactory(creators)\n  return jsx\n}\n\n/**\n * Create a Slate hyperscript function with `options`.\n */\n\nconst createFactory = <T extends HyperscriptCreators>(creators: T) => {\n  const jsx = <S extends keyof T & string>(\n    tagName: S,\n    attributes?: Object,\n    ...children: any[]\n  ): ReturnType<T[S]> => {\n    const creator = creators[tagName]\n\n    if (!creator) {\n      throw new Error(`No hyperscript creator found for tag: <${tagName}>`)\n    }\n\n    if (attributes == null) {\n      attributes = {}\n    }\n\n    if (!isPlainObject(attributes)) {\n      children = [attributes].concat(children)\n      attributes = {}\n    }\n\n    children = children.filter(child => Boolean(child)).flat()\n    const ret = creator(tagName, attributes, children)\n    return ret\n  }\n\n  return jsx\n}\n\n/**\n * Normalize a dictionary of element shorthands into creator functions.\n */\n\nconst normalizeElements = (elements: HyperscriptShorthands) => {\n  const creators: HyperscriptCreators<Element> = {}\n\n  for (const tagName in elements) {\n    const props = elements[tagName]\n\n    if (typeof props !== 'object') {\n      throw new Error(\n        `Properties specified for a hyperscript shorthand should be an object, but for the custom element <${tagName}>  tag you passed: ${props}`\n      )\n    }\n\n    creators[tagName] = (\n      tagName: string,\n      attributes: { [key: string]: any },\n      children: any[]\n    ) => {\n      return createElement('element', { ...props, ...attributes }, children)\n    }\n  }\n\n  return creators\n}\n\nexport { createHyperscript, HyperscriptCreators, HyperscriptShorthands }\n","import {\n  createHyperscript,\n  HyperscriptCreators,\n  HyperscriptShorthands,\n} from './hyperscript'\nimport { createEditor, createText } from './creators'\n\n/**\n * The default hyperscript factory that ships with Slate, without custom tags.\n */\n\nconst jsx = createHyperscript()\n\nexport {\n  jsx,\n  createHyperscript,\n  createEditor,\n  createText,\n  HyperscriptCreators,\n  HyperscriptShorthands,\n}\n"],"names":["ANCHOR","WeakMap","FOCUS","Token","AnchorToken","constructor","props","offset","path","FocusToken","addAnchorToken","text","token","value","length","set","getAnchorOffset","get","addFocusToken","getFocusOffset","STRINGS","WeakSet","resolveDescendants","children","nodes","addChild","child","prev","type","add","Text","isText","c","has","equals","loose","push","Element","isElement","n","Error","flat","Infinity","createAnchor","tagName","attributes","createCursor","createElement","createFocus","createFragment","createSelection","anchor","find","focus","createText","node","delete","Object","assign","createEditor","makeEditor","otherChildren","selectionChild","Range","isRange","descendants","selection","editor","Node","texts","DEFAULT_CREATORS","cursor","element","fragment","createHyperscript","options","elements","elementCreators","normalizeElements","creators","jsx","createFactory","creator","isPlainObject","concat","filter","Boolean","ret"],"mappings":"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"}